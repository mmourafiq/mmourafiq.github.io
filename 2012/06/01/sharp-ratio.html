<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sharp ratio. &mdash; Mourad Mourafiq</title>
    <!--[if lt IE 9]><script src='https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js'></script><![endif]-->
    
    <link rel="stylesheet" href="/assets/app.css">
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<script src="/assets/app.js"></script>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>

<script>
  var HN=[];HN.factory=function(e){return function(){HN.push([e].concat(Array.prototype.slice.call(arguments,0)))};},HN.on=HN.factory("on"),HN.once=HN.factory("once"),HN.off=HN.factory("off"),HN.emit=HN.factory("emit"),HN.load=function(){var e="hn-button.js";if(document.getElementById(e))return;var t=document.createElement("script");t.id=e,t.src="//hn-button.herokuapp.com/hn-button.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)},HN.load();</script>
</script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-34892053-1', 'auto');
  ga('send', 'pageview');
</script>


    <link rel="shortcut icon" href="/favicon.ico?v2" type="image/x-icon" />
    <link rel="alternate" type="application/atom+xml" title="Mourad Mourafiq" href="/atom.xml" />
    <meta name="title" content="Sharp ratio. ">
    <link rel="canonical" href="http://mourafiq.com/2012/06/01/sharp-ratio.html">
     
           
    <meta property="og:title" content="Sharp ratio."/>
    <meta property="og:url" content="http://mourafiq.com/2012/06/01/sharp-ratio.html"/>
    <meta property="og:image" content="http://mourafiq.com/images/posts/stock-market.jpg"/>
    
    <meta property="og:description" content="A basic approach to optimizing the risk and return of a portfolio is to maximize its Sharpe ratio, which is the ratio of its expected return to its standard deviation."/>
    <meta name="description" content="A basic approach to optimizing the risk and return of a portfolio is to maximize its Sharpe ratio, which is the ratio of its expected return to its standard deviation."/>
    
    <meta property="og:site_name" content="Mourad Mourafiq">
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>
<body>

    <header class="site-header">
        <nav>
            <a class="brand" href="/">
                <img src="/images/logo.png" alt="Inc">
            </a>
            <a href="/about.html">About</a>
        </nav>
    </header>

    
<div class="cover  article-cover " style="background-image:url(/images/posts/stock-market.jpg)"></div>


<div class='cover-caption'><a href='/about.html#pictures'>Stock market.</a></div>


<article >
    <div class="container">
        <header>
            
            <div class="meta">
                <!--
                By
                <address><a rel="author" href="" title="Mourad Mourafiq." target="_blank">
                    Mourad Mourafiq.
                </a></address> &mdash;
                -->
                <time pubdate datetime="2012-01-June" title="Jun 01, 2012">
                    Jun 01, 2012
                </time> &mdash;
                
12 min read
            </div>
            
            <h1 class="title">Sharp ratio.</h1>
            <h2 class="subtitle">Calculating sharp ratio with python.</h2>
        </header>

        <section>
            <p>A basic approach to optimizing the risk and return of a portfolio is to maximize its Sharpe ratio, which is the ratio of its expected return to its standard deviation. Standard deviation is a measure of how much you can expect the portfolio to go up or down, so the Sharpe ratio measures how much money you’re expecting to make for each dollar you’re risking. In theory, you can always borrow money at some interest rate, so it’s best to make the investment with the highest Sharpe ratio. That way you can maximize the amount you’re expecting to make without risking more than you’re comfortable with.</p>

<p>Let’s start by calculating the sharp ratio of one equity, and for this example we will use Apple (AAPL).</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno"> 1</span> <span class="kn">import</span> <span class="nn">scipy</span>
<span class="lineno"> 2</span> <span class="kn">from</span> <span class="nn">yahoo_finance</span> <span class="kn">import</span> <span class="n">YahooFinance</span>
<span class="lineno"> 3</span> 
<span class="lineno"> 4</span> <span class="n">VALUE_TYPE</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Date&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;Open&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;High&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;Low&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;Close&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;Volume&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;Adj_Close&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>
<span class="lineno"> 5</span> <span class="n">start_date</span> <span class="o">=</span> <span class="s">&quot;20121101&quot;</span>
<span class="lineno"> 6</span> <span class="n">end_date</span> <span class="o">=</span> <span class="s">&quot;20121201&quot;</span>
<span class="lineno"> 7</span> <span class="n">yf</span> <span class="o">=</span> <span class="n">YahooFinance</span><span class="p">(</span><span class="s">&quot;AAPL&quot;</span><span class="p">)</span>
<span class="lineno"> 8</span> 
<span class="lineno"> 9</span> <span class="k">for</span> <span class="p">(</span><span class="n">symb</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="n">yf</span><span class="o">.</span><span class="n">get_historical_prices</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span> <span class="c">#get historical data from yahoo finance</span>
<span class="lineno">10</span> 
<span class="lineno">11</span>     <span class="n">data</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span> <span class="c">#reverse the time series</span>
<span class="lineno">12</span>     <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="c">#get rid of the header</span>
<span class="lineno">13</span> 
<span class="lineno">14</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="lineno">15</span> <span class="sd">our data look like this :</span>
<span class="lineno">16</span> <span class="sd"> [&#39;Date&#39;       &#39;Open&#39;   &#39;High&#39;   &#39;Low&#39;    &#39;Close&#39;  &#39;Volume&#39;   &#39;Adj Clos&#39;]</span>
<span class="lineno">17</span> <span class="sd"> [&#39;2012-11-01&#39; &#39;598.22&#39; &#39;603.00&#39; &#39;594.17&#39; &#39;596.54&#39; &#39;12903500&#39; &#39;593.8&#39;]</span>
<span class="lineno">18</span> <span class="sd"> [&#39;2012-11-02&#39; &#39;595.89&#39; &#39;596.95&#39; &#39;574.75&#39; &#39;576.80&#39; &#39;21406200&#39; &#39;574.1&#39;]</span>
<span class="lineno">19</span> <span class="sd"> [&#39;2012-11-05&#39; &#39;583.52&#39; &#39;587.77&#39; &#39;577.60&#39; &#39;584.62&#39; &#39;18897700&#39; &#39;581.9&#39;]</span>
<span class="lineno">20</span> <span class="sd"> [&#39;2012-11-06&#39; &#39;590.23&#39; &#39;590.74&#39; &#39;580.09&#39; &#39;582.85&#39; &#39;13389900&#39; &#39;580.2&#39;]</span>
<span class="lineno">21</span> <span class="sd"> [&#39;2012-11-07&#39; &#39;573.84&#39; &#39;574.54&#39; &#39;555.75&#39; &#39;558.00&#39; &#39;28344600&#39; &#39;558.0&#39;]</span>
<span class="lineno">22</span> <span class="sd"> [&#39;2012-11-08&#39; &#39;560.63&#39; &#39;562.23&#39; &#39;535.29&#39; &#39;537.75&#39; &#39;37719500&#39; &#39;537.7&#39;]</span>
<span class="lineno">23</span> <span class="sd"> [&#39;2012-11-09&#39; &#39;540.42&#39; &#39;554.88&#39; &#39;533.72&#39; &#39;547.06&#39; &#39;33211200&#39; &#39;547.0&#39;]</span>
<span class="lineno">24</span> <span class="sd"> [&#39;2012-11-12&#39; &#39;554.15&#39; &#39;554.50&#39; &#39;538.65&#39; &#39;542.83&#39; &#39;18421500&#39; &#39;542.8&#39;]</span>
<span class="lineno">25</span> <span class="sd"> [&#39;2012-11-13&#39; &#39;538.91&#39; &#39;550.48&#39; &#39;536.36&#39; &#39;542.90&#39; &#39;19033900&#39; &#39;542.9&#39;]</span>
<span class="lineno">26</span> <span class="sd"> [&#39;2012-11-14&#39; &#39;545.50&#39; &#39;547.45&#39; &#39;536.18&#39; &#39;536.88&#39; &#39;17041800&#39; &#39;536.8&#39;]</span>
<span class="lineno">27</span> <span class="sd"> [&#39;2012-11-15&#39; &#39;537.53&#39; &#39;539.50&#39; &#39;522.62&#39; &#39;525.62&#39; &#39;28211100&#39; &#39;525.6&#39;]</span>
<span class="lineno">28</span> <span class="sd"> [&#39;2012-11-16&#39; &#39;525.20&#39; &#39;530.00&#39; &#39;505.75&#39; &#39;527.68&#39; &#39;45246200&#39; &#39;527.6&#39;]</span>
<span class="lineno">29</span> <span class="sd"> [&#39;2012-11-19&#39; &#39;540.71&#39; &#39;567.50&#39; &#39;539.88&#39; &#39;565.73&#39; &#39;29404200&#39; &#39;565.7&#39;]</span>
<span class="lineno">30</span> <span class="sd"> [&#39;2012-11-20&#39; &#39;571.91&#39; &#39;571.95&#39; &#39;554.58&#39; &#39;560.91&#39; &#39;22955500&#39; &#39;560.9&#39;]</span>
<span class="lineno">31</span> <span class="sd"> [&#39;2012-11-21&#39; &#39;564.25&#39; &#39;567.37&#39; &#39;556.60&#39; &#39;561.70&#39; &#39;13321500&#39; &#39;561.7&#39;]</span>
<span class="lineno">32</span> <span class="sd"> [&#39;2012-11-23&#39; &#39;567.17&#39; &#39;572.00&#39; &#39;562.60&#39; &#39;571.50&#39; &#39;9743800&#39; &#39;571.5&#39;]</span>
<span class="lineno">33</span> <span class="sd"> [&#39;2012-11-26&#39; &#39;575.90&#39; &#39;590.00&#39; &#39;573.71&#39; &#39;589.53&#39; &#39;22520700&#39; &#39;589.5&#39;]</span>
<span class="lineno">34</span> <span class="sd"> [&#39;2012-11-27&#39; &#39;589.55&#39; &#39;590.42&#39; &#39;580.10&#39; &#39;584.78&#39; &#39;19047500&#39; &#39;584.7&#39;]</span>
<span class="lineno">35</span> <span class="sd"> [&#39;2012-11-28&#39; &#39;577.27&#39; &#39;585.80&#39; &#39;572.26&#39; &#39;582.94&#39; &#39;18602300&#39; &#39;582.9&#39;]</span>
<span class="lineno">36</span> <span class="sd"> [&#39;2012-11-29&#39; &#39;590.22&#39; &#39;594.25&#39; &#39;585.25&#39; &#39;589.36&#39; &#39;18382100&#39; &#39;589.3&#39;]</span>
<span class="lineno">37</span> <span class="sd"> [&#39;2012-11-30&#39; &#39;586.79&#39; &#39;588.40&#39; &#39;582.68&#39; &#39;585.28&#39; &#39;13975700&#39; &#39;585.2&#39;]</span>
<span class="lineno">38</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="lineno">39</span>     <span class="c">#since we are only interested by the Adjusted Closing Price</span>
<span class="lineno">40</span>     <span class="n">adj_prices</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">VALUE_TYPE</span><span class="p">[</span><span class="s">&#39;Adj_Close&#39;</span><span class="p">]]),</span> <span class="n">data</span><span class="p">))</span>
<span class="lineno">41</span> 
<span class="lineno">42</span> <span class="o">&gt;&gt;</span> <span class="p">[</span> <span class="mf">593.8</span>  <span class="mf">574.1</span>  <span class="mf">581.9</span>  <span class="mf">580.2</span>  <span class="mf">558.</span>   <span class="mf">537.7</span>  <span class="mf">547.</span>   <span class="mf">542.8</span>  <span class="mf">542.9</span>  <span class="mf">536.8</span>
<span class="lineno">43</span>    <span class="mf">525.6</span>  <span class="mf">527.6</span>  <span class="mf">565.7</span>  <span class="mf">560.9</span>  <span class="mf">561.7</span>  <span class="mf">571.5</span>  <span class="mf">589.5</span>  <span class="mf">584.7</span>  <span class="mf">582.9</span>  <span class="mf">589.3</span>
<span class="lineno">44</span>    <span class="mf">585.2</span><span class="p">]</span>
<span class="lineno">45</span> 
<span class="lineno">46</span>     <span class="n">total_return</span> <span class="o">=</span> <span class="p">(</span><span class="n">adj_prices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">adj_prices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span> <span class="c">#calculate the total return for apple this month</span>
<span class="lineno">47</span> <span class="o">&gt;&gt;</span> <span class="o">-</span><span class="mf">0.014482990906</span>
<span class="lineno">48</span> 
<span class="lineno">49</span>     <span class="n">daily_return</span> <span class="o">=</span> <span class="p">(</span><span class="n">adj_prices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">/</span><span class="n">adj_prices</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span> <span class="c">#calculate the daily_return</span>
<span class="lineno">50</span> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.03317615</span>  <span class="mf">0.01358648</span> <span class="o">-</span><span class="mf">0.00292146</span> <span class="o">-</span><span class="mf">0.03826267</span> <span class="o">-</span><span class="mf">0.03637993</span>  <span class="mf">0.01729589</span>
<span class="lineno">51</span>    <span class="o">-</span><span class="mf">0.00767824</span>  <span class="mf">0.00018423</span> <span class="o">-</span><span class="mf">0.01123596</span> <span class="o">-</span><span class="mf">0.02086438</span>  <span class="mf">0.00380518</span>  <span class="mf">0.0722138</span>
<span class="lineno">52</span>    <span class="o">-</span><span class="mf">0.00848506</span>  <span class="mf">0.00142628</span>  <span class="mf">0.01744704</span>  <span class="mf">0.03149606</span> <span class="o">-</span><span class="mf">0.00814249</span> <span class="o">-</span><span class="mf">0.0030785</span>
<span class="lineno">53</span>     <span class="mf">0.01097958</span> <span class="o">-</span><span class="mf">0.00695741</span><span class="p">]</span>
<span class="lineno">54</span> 
<span class="lineno">55</span>     <span class="n">avg_daily_return</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">daily_return</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c">#average daily retuen</span>
<span class="lineno">56</span> <span class="o">&gt;&gt;</span> <span class="o">-</span><span class="mf">0.000437386088059</span>
<span class="lineno">57</span> 
<span class="lineno">58</span>     <span class="n">std_daily_return</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">daily_return</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c">#deviation fo daily return</span>
<span class="lineno">59</span> <span class="o">&gt;&gt;</span> <span class="mf">0.0243327696358</span>
<span class="lineno">60</span> 
<span class="lineno">61</span>     <span class="n">sharp_ratio</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">avg_daily_return</span> <span class="o">/</span> <span class="n">std_daily_return</span><span class="p">)</span> <span class="c"># sharp ratio</span>
<span class="lineno">62</span> <span class="o">&gt;&gt;</span> <span class="o">-</span><span class="mf">0.284212663794</span></code></pre></div>

<p>Now we can move to a more complicated example, where we will deal 4 equities, let’s consider Apple (AAPL), Google (GOOG), Gold (GLD), US oil (USO).</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno">  1</span> <span class="kn">import</span> <span class="nn">scipy</span>
<span class="lineno">  2</span> <span class="kn">from</span> <span class="nn">yahoo_finance</span> <span class="kn">import</span> <span class="n">YahooFinance</span>
<span class="lineno">  3</span> 
<span class="lineno">  4</span> 
<span class="lineno">  5</span> <span class="n">VALUE_TYPE</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Date&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;Open&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;High&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;Low&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;Close&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&#39;Volume&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;Adj_Close&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>
<span class="lineno">  6</span> <span class="n">start_date</span> <span class="o">=</span> <span class="s">&quot;20121101&quot;</span>
<span class="lineno">  7</span> <span class="n">end_date</span> <span class="o">=</span> <span class="s">&quot;20121201&quot;</span>
<span class="lineno">  8</span> 
<span class="lineno">  9</span> <span class="n">yf</span> <span class="o">=</span> <span class="n">YahooFinance</span><span class="p">(</span><span class="s">&quot;AAPL,GOOG,GLD,USO&quot;</span><span class="p">)</span>
<span class="lineno"> 10</span> <span class="n">percent</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span> <span class="c">#investment distribution portfolio</span>
<span class="lineno"> 11</span> 
<span class="lineno"> 12</span> <span class="n">all_adj_prices</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno"> 13</span> <span class="n">all_total_return</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno"> 14</span> <span class="n">all_daily_return</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno"> 15</span> <span class="n">all_avg_daily_return</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno"> 16</span> <span class="n">all_std_daily_return</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno"> 17</span> <span class="n">all_sharp_ratio</span> <span class="o">=</span> <span class="p">[]</span>
<span class="lineno"> 18</span> 
<span class="lineno"> 19</span> <span class="n">ticker</span> <span class="o">=</span> <span class="mi">0</span>
<span class="lineno"> 20</span> <span class="k">for</span> <span class="p">(</span><span class="n">symb</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="n">yf</span><span class="o">.</span><span class="n">get_historical_prices</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">):</span>
<span class="lineno"> 21</span>     <span class="n">data</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span> <span class="c">#reverse the time series</span>
<span class="lineno"> 22</span>     <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="c">#get rid of the header</span>
<span class="lineno"> 23</span>     <span class="n">adj_prices</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">VALUE_TYPE</span><span class="p">[</span><span class="s">&#39;Adj_Close&#39;</span><span class="p">]]),</span> <span class="n">data</span><span class="p">))</span>
<span class="lineno"> 24</span>     <span class="n">all_adj_prices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_prices</span><span class="p">)</span>
<span class="lineno"> 25</span>     <span class="n">total_return</span> <span class="o">=</span> <span class="p">(</span><span class="n">adj_prices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">adj_prices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span> <span class="c">#calculate the total return for apple this month</span>
<span class="lineno"> 26</span>     <span class="n">all_total_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_return</span><span class="p">)</span>
<span class="lineno"> 27</span>     <span class="n">daily_return</span> <span class="o">=</span> <span class="p">(</span><span class="n">adj_prices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">/</span><span class="n">adj_prices</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span> <span class="c">#calculate the daily_return</span>
<span class="lineno"> 28</span>     <span class="n">all_daily_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">daily_return</span><span class="p">)</span>
<span class="lineno"> 29</span>     <span class="n">avg_daily_return</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">daily_return</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c">#average daily retuen</span>
<span class="lineno"> 30</span>     <span class="n">all_avg_daily_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_daily_return</span><span class="p">)</span>
<span class="lineno"> 31</span>     <span class="n">std_daily_return</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">daily_return</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c">#deviation fo daily return</span>
<span class="lineno"> 32</span>     <span class="n">all_std_daily_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">std_daily_return</span><span class="p">)</span>
<span class="lineno"> 33</span>     <span class="n">sharp_ratio</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">avg_daily_return</span> <span class="o">/</span> <span class="n">std_daily_return</span><span class="p">)</span> <span class="c"># sharp ratio</span>
<span class="lineno"> 34</span>     <span class="n">all_sharp_ratio</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sharp_ratio</span><span class="p">)</span>
<span class="lineno"> 35</span> 
<span class="lineno"> 36</span>   <span class="sd">&quot;&quot;&quot;</span>
<span class="lineno"> 37</span> <span class="sd">  our prices</span>
<span class="lineno"> 38</span> <span class="sd">  GOOG : 687.5,  687.9,  682.9,  681.7,  667.1,  652.2,  663. ,  665.9,</span>
<span class="lineno"> 39</span> <span class="sd">        659. ,  652.5,  647.2,  647.1,  668.2,  669.9,  665.8,  667.9,</span>
<span class="lineno"> 40</span> <span class="sd">        661.1,  670.7,  683.6,  691.8,  698.3</span>
<span class="lineno"> 41</span> 
<span class="lineno"> 42</span> <span class="sd">  USO : 32. ,  31.3,  31.6,  32.5,  31.2,  31.3,  31.7,  31.5,  31.4,</span>
<span class="lineno"> 43</span> <span class="sd">        31.7,  31.4,  31.9,  32.6,  31.9,  32.1,  32.3,  32.1,  31.9,</span>
<span class="lineno"> 44</span> <span class="sd">        31.7,  32.1,  32.5</span>
<span class="lineno"> 45</span> 
<span class="lineno"> 46</span> <span class="sd">  AAPL : 593.8,  574.1,  581.9,  580.2,  558. ,  537.7,  547. ,  542.8,</span>
<span class="lineno"> 47</span> <span class="sd">        542.9,  536.8,  525.6,  527.6,  565.7,  560.9,  561.7,  571.5,</span>
<span class="lineno"> 48</span> <span class="sd">        589.5,  584.7,  582.9,  589.3,  585.2</span>
<span class="lineno"> 49</span> 
<span class="lineno"> 50</span> <span class="sd">  GLD : 166. ,  162.6,  163.2,  166.3,  166.4,  167.9,  167.8,  167.4,</span>
<span class="lineno"> 51</span> <span class="sd">        167.1,  167.1,  166. ,  165.8,  167.8,  167.3,  167.5,  169.6,</span>
<span class="lineno"> 52</span> <span class="sd">        169.4,  168.7,  166.5,  167.1,  166.</span>
<span class="lineno"> 53</span> 
<span class="lineno"> 54</span> <span class="sd">  total return for each stock : [0.015709090909090895, 0.015625, -0.014482990906028781, 0.0]</span>
<span class="lineno"> 55</span> <span class="sd">  daily return :</span>
<span class="lineno"> 56</span> <span class="sd">  GOOG : 0.00058182, -0.0072685 , -0.00175721, -0.02141705, -0.02233548,</span>
<span class="lineno"> 57</span> <span class="sd">        0.01655934,  0.00437406, -0.01036192, -0.00986343, -0.00812261,</span>
<span class="lineno"> 58</span> <span class="sd">       -0.00015451,  0.03260702,  0.00254415, -0.00612032,  0.0031541 ,</span>
<span class="lineno"> 59</span> <span class="sd">       -0.01018116,  0.01452125,  0.01923364,  0.01199532,  0.00939578</span>
<span class="lineno"> 60</span> 
<span class="lineno"> 61</span> <span class="sd">  USO : -0.021875  ,  0.00958466,  0.02848101, -0.04      ,  0.00320513,</span>
<span class="lineno"> 62</span> <span class="sd">        0.01277955, -0.00630915, -0.0031746 ,  0.00955414, -0.00946372,</span>
<span class="lineno"> 63</span> <span class="sd">        0.01592357,  0.02194357, -0.02147239,  0.00626959,  0.00623053,</span>
<span class="lineno"> 64</span> <span class="sd">       -0.00619195, -0.00623053, -0.00626959,  0.0126183 ,  0.01246106</span>
<span class="lineno"> 65</span> 
<span class="lineno"> 66</span> <span class="sd">  AAPL : -0.03317615,  0.01358648, -0.00292146, -0.03826267, -0.03637993,</span>
<span class="lineno"> 67</span> <span class="sd">        0.01729589, -0.00767824,  0.00018423, -0.01123596, -0.02086438,</span>
<span class="lineno"> 68</span> <span class="sd">        0.00380518,  0.0722138 , -0.00848506,  0.00142628,  0.01744704,</span>
<span class="lineno"> 69</span> <span class="sd">        0.03149606, -0.00814249, -0.0030785 ,  0.01097958, -0.00695741</span>
<span class="lineno"> 70</span> 
<span class="lineno"> 71</span> <span class="sd">  GLD : -0.02048193,  0.00369004,  0.0189951 ,  0.00060132,  0.00901442,</span>
<span class="lineno"> 72</span> <span class="sd">       -0.00059559, -0.00238379, -0.00179211,  0.        , -0.00658288,</span>
<span class="lineno"> 73</span> <span class="sd">       -0.00120482,  0.01206273, -0.00297974,  0.00119546,  0.01253731,</span>
<span class="lineno"> 74</span> <span class="sd">       -0.00117925, -0.00413223, -0.0130409 ,  0.0036036 , -0.00658288</span>
<span class="lineno"> 75</span> 
<span class="lineno"> 76</span> <span class="sd">  average daily return for each stock : [0.00086921414889110646, 0.00090320887851679248, -0.00043738608805856115, 3.7192619905374034e-05]</span>
<span class="lineno"> 77</span> <span class="sd">  std deviation for each stock : [0.01340975818314491, 0.015929201121363604, 0.024332769635802963, 0.008623865082371179]</span>
<span class="lineno"> 78</span> <span class="sd">  sharp ratio for each stock : [1.0248866711092259, 0.8965287201907356, -0.28421266379411581, 0.068190648813791305]</span>
<span class="lineno"> 79</span> <span class="sd">  &quot;&quot;&quot;</span>
<span class="lineno"> 80</span> 
<span class="lineno"> 81</span>   <span class="n">corr</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">all_adj_prices</span><span class="p">)</span>
<span class="lineno"> 82</span>   <span class="sd">&quot;&quot;&quot;</span>
<span class="lineno"> 83</span> <span class="sd">  [[ GOOG        USO         AAPL        GLD]</span>
<span class="lineno"> 84</span> <span class="sd">   [ 1.          0.35796266  0.83675929 -0.38083073]</span>
<span class="lineno"> 85</span> <span class="sd">   [ 0.35796266  1.          0.49457339  0.33637871]</span>
<span class="lineno"> 86</span> <span class="sd">   [ 0.83675929  0.49457339  1.         -0.04349294]</span>
<span class="lineno"> 87</span> <span class="sd">   [-0.38083073  0.33637871 -0.04349294  1.        ]]</span>
<span class="lineno"> 88</span> <span class="sd">  &quot;&quot;&quot;</span>
<span class="lineno"> 89</span> 
<span class="lineno"> 90</span> <span class="n">portfolio_total_return</span> <span class="o">=</span> <span class="bp">None</span>
<span class="lineno"> 91</span> <span class="n">portfolio_daily_return</span> <span class="o">=</span> <span class="bp">None</span>
<span class="lineno"> 92</span> 
<span class="lineno"> 93</span> <span class="k">for</span> <span class="n">ticker</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<span class="lineno"> 94</span>     <span class="k">if</span> <span class="n">ticker</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="lineno"> 95</span>         <span class="n">portfolio_daily_return</span> <span class="o">=</span> <span class="n">all_daily_return</span><span class="p">[</span><span class="n">ticker</span><span class="p">]</span> <span class="o">*</span> <span class="n">percent</span><span class="p">[</span><span class="n">ticker</span><span class="p">]</span>
<span class="lineno"> 96</span>         <span class="n">portfolio_total_return</span> <span class="o">=</span> <span class="n">all_total_return</span><span class="p">[</span><span class="n">ticker</span><span class="p">]</span> <span class="o">*</span> <span class="n">percent</span><span class="p">[</span><span class="n">ticker</span><span class="p">]</span>
<span class="lineno"> 97</span>     <span class="k">else</span><span class="p">:</span>
<span class="lineno"> 98</span>         <span class="n">portfolio_daily_return</span> <span class="o">+=</span> <span class="n">all_daily_return</span><span class="p">[</span><span class="n">ticker</span><span class="p">]</span> <span class="o">*</span> <span class="n">percent</span><span class="p">[</span><span class="n">ticker</span><span class="p">]</span>
<span class="lineno"> 99</span>         <span class="n">portfolio_total_return</span> <span class="o">+=</span> <span class="n">all_total_return</span><span class="p">[</span><span class="n">ticker</span><span class="p">]</span> <span class="o">*</span> <span class="n">percent</span><span class="p">[</span><span class="n">ticker</span><span class="p">]</span>
<span class="lineno">100</span> 
<span class="lineno">101</span> <span class="n">portfolio_avg_daily_return</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">portfolio_daily_return</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno">102</span> <span class="n">portfolio_std_daily_return</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">portfolio_daily_return</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno">103</span> <span class="n">portfolio_sharp_ratio</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">portfolio_avg_daily_return</span> <span class="o">/</span> <span class="n">portfolio_std_daily_return</span><span class="p">)</span> <span class="c"># sharp ratio</span>
<span class="lineno">104</span> 
<span class="lineno">105</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="lineno">106</span> <span class="sd">portfolio daily return :</span>
<span class="lineno">107</span> <span class="sd">[ -2.05026424e-02   5.79317575e-03   6.46328287e-03  -2.65390640e-02</span>
<span class="lineno">108</span> <span class="sd">  -1.78521880e-02   1.28560048e-02  -3.40091395e-03  -3.35140050e-03</span>
<span class="lineno">109</span> <span class="sd">  -5.52711836e-03  -1.31125392e-02   3.63101326e-03   4.27413546e-02</span>
<span class="lineno">110</span> <span class="sd">  -6.57479444e-03   2.19962885e-04   1.12093815e-02   8.88849236e-03</span>
<span class="lineno">111</span> <span class="sd">  -1.38771006e-03   2.83893335e-05   1.00041289e-02   1.18563923e-04]</span>
<span class="lineno">112</span> 
<span class="lineno">113</span> <span class="sd">portfolio total return : 0.000477826364861</span>
<span class="lineno">114</span> <span class="sd">portfolio average daily return : 0.000185268957758</span>
<span class="lineno">115</span> <span class="sd">portfolio std deviation daily return : 0.0143152971765</span>
<span class="lineno">116</span> <span class="sd">portfolio sharp ratio: 0.20463140898</span>
<span class="lineno">117</span> 
<span class="lineno">118</span> <span class="sd">&quot;&quot;&quot;</span></code></pre></div>


            
<div class="social">
  
  <div class='twitter'>
    <a href="https://twitter.com/share" class="twitter-share-button"  data-text="Sharp ratio." data-related="mmourafiq">Tweet</a>
  </div>
  

  
  <div class='facebook'>
    <div class="fb-share-button" data-layout="button_count"></div>
  </div>
  

  
  <div class='google'>
    <div class="g-plusone" data-size="medium"></div>
  </div>
  
    
  
  <div class='hn'>
    <a href="https://news.ycombinator.com/submit" class="hn-button" data-title="Sharp ratio." data-url="http://mourafiq.com/2012/06/01/sharp-ratio.html" data-count="horizontal">Vote on Hacker News</a>
  </div>
  

  
  <div class='reddit'>
    <a href="//www.reddit.com/submit" onclick="window.open('//www.reddit.com/submit?url=http://mourafiq.com/2012/06/01/sharp-ratio.html&title=Sharp+ratio.'); return false"> <img src="//www.redditstatic.com/spreddit7.gif" alt="submit to reddit" border="0" /> </a>
  </div>
  
</div>

        </section>

        <footer>
            <address>
                <img src="/images/logo.png">
                <p>
                Written by <strong><a rel="author" href="https://twitter.com/mmourafiq" title="Mourad Mourafiq." target="_blank">Mourad Mourafiq.</a></strong><br>
                    <span class="muted">Maths, Technology, Philosophy, Startups, ...</span>
                </p>
            </address>
            
            
            <section class="post_summary">
                <h3 class="title">Next up: <a href="/2012/06/15/users-emotions.html" rel="prefetch">Emotions from the user side</a></h3>
                <p>Objective measures of emotion is the ability to recognize emotional states through direct observation.</p>
                <hr>
            </section>
             
            
            
            <section class="post_summary">
                <h3 class="title">Previous story: <a href="/2012/05/20/simple-python-object-to-get-stock-data.html" rel="prefetch">A simple python object to get stock data!</a></h3>
                <p>YahooFinance is a python interface that lets you get stock related data from yahoo.</p>
                <hr>
            </section>
             
            
            <section>
                <div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'mourafiq';

  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
            </section>
            
        </footer>
    </div>
</article>


    <footer class="site-footer">
        <div class="container">
            &copy; 2016 Mourad Mourafiq

            <nav>
                <a href="/">Blog</a> &middot;
                <a href="/about.html">About</a>
            </nav>

            <nav class="social">
                
<a href="https://twitter.com/mmourafiq" title="Follow on Twitter" target="_blank"><i class="icon icon-twitter"></i></a>


<a href="https://github.com/mouradmourafiq" title="Watch on Github" target="_blank"><i class="icon icon-github"></i></a>


<a href="/atom.xml" title="RSS Feed">
  <i class="icon icon-rss"></i>
</a>

            </nav>
            <div>Based on Incorporated theme by <a href="https://sendtoinc.com">Inc</a></div>
        </div>
    </footer>

</body>
</html>
